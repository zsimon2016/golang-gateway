# golang-gateway

本项目全部采用 Golang 开发完成，目前已规模化商用。项目由网关、微服务模块和内部高速共享模块组成，充分利用计算机 的多核、内存来实现高性能数据交互。模块间相互独立互无干涉。模块间的数据交互是由共享模块来完成的，由于共享模块 是基于内存的数据管理，所以性能极高。  
一、网关，由 Golang RPC 作为核心构建的微服务访问入口、治理中心。具有服务发现、服务治理、高性能等特性，并且支持 Nacos，etcd 等注册中心。网关能起到用户信息维护及权限控制等作用。   
二、微服务模块，微服务模块根据算力可伸缩，主要担负业务数据处理响应，其自身无法独立提供服务，需要注册后由网关 通过 RPC 调用来完成业务处理。  
三、共享模块 其主要功能是解决微服务模块独立自治问题。因为模块间必然会有数据交互，而如果将交互硬绑定，系统稳定 性、可维护性、扩展性大幅下降。模块间需要交互、或者需要读取共享数据时会请求该模块。交互时类似于 CPU 的角色，而 读取共享数据时相当于内存的角色。这样确保系高效且稳定。  
本框架目前支持 http 协议，如果需要用 https 则需要借助 nginx 。主要考虑其作为内部服务这个角色比较适合。

### 分布式微服务网关
这是一个分布式微服务网关，由RPC作为核心构建的微服务访问入口、治理中心。

本网关选择以etcd而没有以nacos作为注册中心是因为与go更加契合，同时占用的内存更低，在使用之前请自行安装好etcd，默认使用本地的2379作为注册中心端口，如果自定义注册中心，则只需要加上启动参数。-EtcdAddr ip:port。ip 和port自行替换。

### 监听  
默认监听9092端口，作为http服务的端口，如果需要使用https请与nginx配合使用。

### 启动  
```go run service.go ```  
### 参数说明:  
- basePath  etcd 服务注册路径，一般无需修改，各个微服务也是注册在这个路径下的。

- configPath  配置文件路径，默认./config.json 可以自行指定。这个文件内容其实是可以用其他配置中心所替代，后期会有升级。原来只需要一个nacos就可以，因为轻量化，把配置中心去除了。配置文件中的gatewayAddress、services_list、redis字段名请不要修改。services_list中的key是微服务向注册中心注册的服务名称，注意val的首字母应该大写。


### 微服务启动  
``` go run service.go```  
启动方式相同，确保注册地址与网关保持一致

### 访问方式  
假设网关所在服务器在本地。名为bi的微服务有一个方法叫do，则用以下方式请求，uni是公开访问，acc则是受限访问，可以加入鉴权等功能。可在配置文件中调整。
http://localhost:9092/v1/uni/bi/do，支持post,get;
